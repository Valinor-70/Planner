You are an autonomous Senior Full-Stack Engineer acting as an Agent. Your goal is to scaffold, implement, and verify a complete local-first planner app following the detailed specification. Execute this plan step-by-step.

Feel Free to edit the styling/ plan as you go, but do not deviate too far.

1. PROJECT INITIALIZATION & SETUP
Action: Execute the following setup steps.

Initialize a new Astro project (use npm create astro@latest with the 'empty' template). Name it zenplan.

Enter the directory (cd zenplan).

Install dependencies immediately:

npx astro add react (Accept all prompts).

npx astro add tailwind (Accept all prompts).

npm install framer-motion clsx tailwind-merge lucide-react date-fns

npm install dexie @dnd-kit/core @dnd-kit/sortable @dnd-kit/utilities dexie-react-hooks

npm install -D @types/react @types/react-dom

2. ARCHITECTURE & FILE CREATION
Action: Create the following folder structure and files. Write the full implementation code for each.

A. Database Layer (Client-Side Only)
File: src/lib/db.ts Logic:

Initialize Dexie with a database named ZenPlanDB.

Define the Task interface and export it.

Create a store tasks with schema: ++id, title, date, status, priority.

Export the typed db instance and a set of utility functions for CRUD operations (addTask, updateTask, deleteTask).

B. Domain Types
File: src/types.ts Content: Define interfaces for Task, Priority ('low'|'med'|'high'), and TaskStatus ('todo'|'done').

C. Components (React Islands)
Location: src/components/planner/ Create the following interactive components:

TaskCard.tsx:

Props: task object, onToggleComplete.

Features: Draggable (use @dnd-kit/sortable hooks).

Animation: Use framer-motion's AnimatePresence and motion.div. When status changes to 'done', apply a smooth strikethrough/fade transition and a subtle completion pulse effect.

UI: Glassmorphism style (bg-white/50 backdrop-blur-sm), rounded-xl.

Column.tsx:

Props: date (ISO string for the day), tasks (array), id (the droppable ID).

Features: Droppable area (use @dnd-kit/core's useDroppable).

UI: Clear visual separation for the day (e.g., "Mon 16").

TaskBoard.tsx (The Controller):

Logic: Use useLiveQuery from dexie-react-hooks to fetch all tasks reactively.

Logic: Implement DndContext and the core onDragEnd handler.

CRITICAL onDragEnd Logic: Upon drag completion, calculate the new date based on the drop column's ID and call the updateTask function from src/lib/db.ts to persist the date change.

UI: Implement view switching logic between 'Daily', 'Weekly', and 'Monthly' views.

NewTaskModal.tsx:

UI: A functional, accessible modal with validation.

Fields: Inputs for all Task schema fields, including a date picker and a segmented control for Priority selection.

Logic: On submit, call addTask from src/lib/db.ts and close the modal.

D. Main Page (Astro)
File: src/pages/index.astro Logic:

Set the page title and meta tags.

Import TaskBoard from the components.

Render the main component using the strict client directive: <TaskBoard client:only="react" />.

3. UI/UX DESIGN SPECIFICATION
Action: Apply the "Modern Soft UI" aesthetic using these Tailwind specifications.

Palette: slate (Backgrounds), violet (Primary/Active), emerald (Success/Done).

Glassmorphism Effect: Use bg-white/50 backdrop-blur-sm on task cards.

Priority Visuals (TaskCard):

High: border-rose-500

Med: border-amber-500

Low: border-sky-500

Typography: Ensure high contrast and use font-sans throughout.

4. ERROR PREVENTION PROTOCOLS (Critical Review)
Verification: Prioritize these checks during implementation:

SSR Protection: Ensure all code interacting with Dexie or window (DOM, localStorage, etc.) is isolated within client-side React hooks or components guarded by the client:only="react" directive on the Astro page.

Reactivity: Confirm that the TaskBoard uses useLiveQuery so that creating, updating, or dragging a task instantly reflects in the UI without a manual refresh.

Persistence Test: After implementing the onDragEnd logic, the Agent must execute a test: drag a task to a different day, refresh the browser, and confirm the task remains in the new day.

5. EXECUTION & DELIVERY
Start by running the installation commands, then proceed to create the files in the most logical order (DB first, then Types, then Components, then Astro page). Once finished, the system must be verified via the browser.

NOTE FROM Project Manager:
 *Please create a landing page, and then setup page, dashboard *
 *The UI must be SaaS grade and Must blow us away *
 *WHEN DONE, REEVALUTE ALL PAGES, WITH A FRESH MIND TO ENSURE COOHERANCE AND AN AMAZING PROJECT*
